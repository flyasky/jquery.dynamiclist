/*
 Dynamic List v 1.0.0  
 Copyright (c) 2012 Ike Lin.  All rights reserved.  Licensed under the GPL v3.
 */
(function(a){a.fn.dynamiclist=function(d){a(this).each(function(){var j=a(this);var h=a.extend({templateClass:"list-template",itemClass:"list-item",addClass:"list-add",removeClass:"list-remove",minSize:1,maxSize:10,withEvents:false,addCallbackFn:null,removeCallbackFn:null},d);j.find("."+h.templateClass).hide();var i=j.find("."+h.itemClass).length;while(h.minSize>i){f(j,null,h);i++}j.find("."+h.addClass).click(function(k){f(j,k,h)});j.find("."+h.removeClass).click(function(k){e(j,a(this),k,h)});j.parents("form:first").submit(function(){j.find("."+h.templateClass).remove()})});function f(m,l,h){var k=m.find("."+h.itemClass).length;if(k<h.maxSize){var j=m.find("."+h.templateClass).clone(h.withEvents);j.show();j.find("."+h.removeClass).click(function(n){e(m,a(this),n,h)});b(j,k,true);g(j);var i=m.find("."+h.itemClass+":last");if(i.length==0){i=m.find("."+h.templateClass)}i.after(j);if(h.addCallbackFn!=null){h.addCallbackFn(j)}}if(l!=null){l.preventDefault()}}function e(m,i,l,h){var k=m.find("."+h.itemClass).length;var j=i.parents("."+h.itemClass+":first");if(k==h.minSize){g(j)}else{j.remove()}c(m,h);if(h.removeCallbackFn!=null){h.removeCallbackFn(j)}l.preventDefault()}function b(i,j,h){i.find("label, input, select, textarea").each(function(){var l=["class","name","id","for"];for(var m=0;m<l.length;m++){var k=a(this).attr(l[m]);if(k){if(h){k=k.replace(/\#\./,j+".");k=k.replace(/\[\#\]\./,"["+j+"].")}else{k=k.replace(/\d+\./,j+".");k=k.replace(/\[\d+\]\./,"["+j+"].")}a(this).attr(l[m],k)}}});if(h){i.removeClass("list-template").addClass("list-item")}}function c(i,h){i.find("."+h.itemClass).each(function(){var j=i.find("."+h.itemClass).index(this);var k=a(this);b(k,j,false)})}function g(h){h.find("input[type=text], textarea").val("");h.find("input[type=radio]").attr({checked:false});h.find("input[type=checkbox]").attr({checked:false})}}})(jQuery);