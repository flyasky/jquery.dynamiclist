/*
 Dynamic List v 1.0.0
 Copyright (c) 2012 Ike Lin.  All rights reserved.  Licensed under the GPL v3.
 */
;(function(a){a.fn.dynamiclist=function(d){if(this.length>1){this.each(function(){a(this).dynamiclist(d)});return this}var g=a.extend({templateClass:"list-template",itemClass:"list-item",addClass:"list-add",removeClass:"list-remove",minSize:1,maxSize:10,withEvents:false,addCallbackFn:null,removeCallbackFn:null},d);var f=function(o,n,j){var m=o.find("."+j.itemClass).length;if(m<j.maxSize){var l=o.find("."+j.templateClass).clone(j.withEvents);l.show();l.find("."+j.removeClass).click(function(p){e(o,a(this),p,j)});b(l,m,true);i(l);var k=o.find("."+j.itemClass+":last");if(k.length==0){k=o.find("."+j.templateClass)}k.after(l);if(j.addCallbackFn!=null){j.addCallbackFn(l)}}if(n!=null){n.preventDefault()}};var e=function(o,k,n,j){var m=o.find("."+j.itemClass).length;var l=k.parents("."+j.itemClass+":first");if(m==j.minSize){i(l)}else{l.remove()}c(o,j);if(j.removeCallbackFn!=null){j.removeCallbackFn(l)}n.preventDefault()};var b=function(k,l,j){k.find("label, input, select, textarea").each(function(){var n=["class","name","id","for"];for(var o=0;o<n.length;o++){var m=a(this).attr(n[o]);if(m){if(j){m=m.replace(/\#\./,l+".");m=m.replace(/\[\#\]\./,"["+l+"].")}else{m=m.replace(/\d+\./,l+".");m=m.replace(/\[\d+\]\./,"["+l+"].")}a(this).attr(n[o],m)}}});if(j){k.removeClass("list-template").addClass("list-item")}};var c=function(k,j){k.find("."+j.itemClass).each(function(){var l=k.find("."+j.itemClass).index(this);b(a(this),l,false)})};var i=function(j){j.find("input[type=text], textarea").val("");j.find("input[type=radio]").attr({checked:false});j.find("input[type=checkbox]").attr({checked:false})};var h=function(k){k.find("."+g.templateClass).hide();var j=k.find("."+g.itemClass).length;while(g.minSize>j){f(k,null,g);j++}k.find("."+g.addClass).click(function(l){f(k,l,g)});k.find("."+g.removeClass).click(function(l){e(k,a(this),l,g)});k.parents("form:first").submit(function(){k.find("."+g.templateClass).remove()});return k};this.removeListTemplate=function(){a(this).find("."+g.templateClass).remove()};return h(this)}})(jQuery);